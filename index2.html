<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>For Soline</title>
  <style>
    :root{
      --bg1:#fff1f6;
      --bg2:#ffe1ee;
      --ink:#23161c;
      --muted:rgba(35,22,28,.72);
      --card:#ffffffd9;
      --shadow:0 26px 70px rgba(0,0,0,.18);
      --shadow2:0 14px 30px rgba(0,0,0,.16);
      --accent:#ff3b7b;
      --accent2:#ff6aa1;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color:var(--ink);
      background:
        radial-gradient(1200px 700px at 18% 12%, #fff 0%, var(--bg1) 45%, var(--bg2) 100%);
      overflow:hidden;
    }

    .wrap{
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      position:relative;
    }

    .panel{
      width:min(980px, 96vw);
      display:grid;
      grid-template-columns: 1fr 420px;
      gap:18px;
      align-items:center;
    }

    @media (max-width: 980px){
      body{overflow:auto}
      .panel{grid-template-columns: 1fr; gap:14px}
    }

    .left{
      position:relative;
      min-height:640px;
      border-radius:28px;
      background: rgba(255,255,255,.35);
      border: 1px solid rgba(255,255,255,.7);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .leftHeader{
      padding:18px 18px 8px 18px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }
    .title{
      margin:0;
      font-size: clamp(26px, 3vw, 38px);
      letter-spacing:.2px;
    }
    .subtitle{
      margin:6px 0 0 0;
      color:var(--muted);
      font-size:15px;
      line-height:1.35;
      max-width: 520px;
    }

    .counter{
      background: rgba(255,255,255,.6);
      border: 1px solid rgba(35,22,28,.10);
      padding:10px 12px;
      border-radius: 999px;
      font-weight: 750;
      color: rgba(35,22,28,.78);
      box-shadow: var(--shadow2);
      user-select:none;
      white-space:nowrap;
    }

    .table{
      position:absolute;
      inset:92px 12px 12px 12px;
      border-radius:22px;
      background: rgba(255,255,255,.28);
      border: 1px solid rgba(35,22,28,.08);
      overflow:hidden;
    }

    .paperGrain{
      position:absolute;
      inset:0;
      background:
        radial-gradient(circle at 20% 30%, rgba(255,255,255,.40), transparent 45%),
        radial-gradient(circle at 80% 10%, rgba(255,255,255,.28), transparent 40%),
        radial-gradient(circle at 70% 80%, rgba(255,255,255,.22), transparent 40%);
      opacity:.9;
      pointer-events:none;
    }

    .polaroid{
      position:absolute;
      width: 240px;
      height: 300px;
      border-radius: 14px;
      background: #fff;
      box-shadow: var(--shadow2);
      border: 1px solid rgba(35,22,28,.10);
      transform-style: preserve-3d;
      cursor:pointer;
      user-select:none;
      will-change: transform;
    }

    .polaroidInner{
      position:absolute;
      inset:0;
      transform-style: preserve-3d;
      transition: transform .55s cubic-bezier(.2,.8,.2,1);
      border-radius:14px;
    }

    .polaroid.isFlipped .polaroidInner{
      transform: rotateY(180deg);
    }

    .face{
      position:absolute;
      inset:0;
      backface-visibility:hidden;
      border-radius:14px;
      overflow:hidden;
    }

    .front{
      background:#fff;
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .photoFrame{
      flex:1;
      border-radius: 10px;
      background: #f2f2f2;
      overflow:hidden;
      border: 1px solid rgba(35,22,28,.10);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .photoFrame img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
    }

    .scribble{
      font-family: ui-rounded, "Bradley Hand", "Comic Sans MS", system-ui;
      font-weight: 650;
      font-size: 15px;
      color: rgba(35,22,28,.78);
      padding: 0 4px 2px 4px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .stamp{
      font-size: 12px;
      opacity:.72;
      white-space:nowrap;
    }

    .back{
      background:
        linear-gradient(0deg, rgba(255,59,123,.08), rgba(255,106,161,.06)),
        radial-gradient(900px 400px at 20% 0%, rgba(255,255,255,.65), rgba(255,255,255,.35));
      transform: rotateY(180deg);
      padding:14px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      border-radius:14px;
    }

    .backTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      color: rgba(35,22,28,.78);
      font-weight: 800;
      letter-spacing:.2px;
    }
    .heartDot{
      width:28px;
      height:28px;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      display:grid;
      place-items:center;
      color:#fff;
      box-shadow: 0 10px 22px rgba(255,59,123,.28);
      font-size: 14px;
    }

    .caption{
      margin:12px 0 0 0;
      font-size: 15px;
      line-height: 1.45;
      color: rgba(35,22,28,.86);
      font-weight: 650;
    }

    .note{
      margin:10px 0 0 0;
      font-size: 13px;
      line-height: 1.35;
      color: rgba(35,22,28,.68);
    }

    .tapHint{
      margin:0;
      font-size: 12px;
      opacity:.72;
    }

    .right{
      border-radius:28px;
      background: var(--card);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,.72);
      box-shadow: var(--shadow);
      padding:18px;
    }

    .right h2{
      margin:0;
      font-size: 18px;
      letter-spacing:.2px;
    }
    .right p{
      margin:10px 0 0 0;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.45;
    }

    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:14px;
    }
    .btn{
      border:0;
      border-radius: 999px;
      padding: 11px 14px;
      font-weight: 780;
      cursor:pointer;
      background: rgba(255,255,255,.82);
      border: 1px solid rgba(35,22,28,.10);
      box-shadow: 0 10px 22px rgba(0,0,0,.10);
      transition: transform .12s ease, filter .12s ease;
    }
    .btn:active{transform: translateY(1px)}
    .primary{
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color:#fff;
      border:0;
      box-shadow: 0 14px 30px rgba(255,59,123,.28);
    }

    .envelope{
      margin-top:14px;
      border-radius: 20px;
      border: 1px solid rgba(35,22,28,.10);
      background: rgba(255,255,255,.75);
      padding:14px;
      display:none;
    }
    .envelope.show{display:block}
    .envelopeTitle{
      font-weight: 900;
      margin:0;
      letter-spacing:.2px;
    }
    .envelopeText{
      margin:8px 0 0 0;
      color: rgba(35,22,28,.82);
      font-size: 14px;
      line-height: 1.5;
    }

    .toast{
      position: fixed;
      left:50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(35,22,28,.88);
      color:#fff;
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 13px;
      opacity:0;
      pointer-events:none;
      transition: opacity .22s ease, transform .22s ease;
      z-index: 30;
    }
    .toast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(-6px);
    }

    .modalBackdrop{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.28);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index: 50;
    }
    .modalBackdrop.show{display:flex}
    .modal{
      width:min(560px, 96vw);
      background:#fff;
      border-radius: 20px;
      box-shadow: 0 22px 70px rgba(0,0,0,.22);
      padding:16px;
      text-align:left;
    }
    .modalHeader{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }
    .modalTitle{
      margin:0;
      font-size: 16px;
      font-weight: 900;
    }
    .modalClose{
      border-radius:999px;
      padding:8px 12px;
      font-weight: 780;
      border: 1px solid rgba(35,22,28,.10);
      background: rgba(245,245,245,.9);
      cursor:pointer;
    }
    .modalHint{
      margin:0 0 10px 0;
      font-size: 13px;
      color: rgba(35,22,28,.72);
      line-height: 1.35;
    }
    .copyArea{
      width:100%;
      min-height: 140px;
      resize: vertical;
      border-radius: 14px;
      border: 1px solid rgba(35,22,28,.14);
      padding:12px;
      font-size: 14px;
      line-height: 1.45;
      outline:none;
    }

    .srOnly{
      position:absolute;
      width:1px;
      height:1px;
      padding:0;
      margin:-1px;
      overflow:hidden;
      clip: rect(0,0,0,0);
      white-space:nowrap;
      border:0;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="panel">
      <section class="left" aria-live="polite">
        <div class="leftHeader">
          <div>
            <h1 class="title">Stack of Moments</h1>
            <p class="subtitle">Click a Polaroid to flip it. When you have seen them all, open the envelope.</p>
          </div>
          <div class="counter" id="counter">0 of 8 flipped</div>
        </div>

        <div class="table" id="table">
          <div class="paperGrain"></div>
        </div>

        <span class="srOnly" id="a11y"></span>
      </section>

      <aside class="right">
        <h2>For Soline</h2>
        <p>
          These are tiny interactive postcards for the most precious happy moments!!! Hope you flip it all.
        </p>

        <div class="actions">
          <button class="btn" id="shuffleBtn">Shuffle</button>
          <button class="btn" id="flipAllBtn">Flip all</button>
          <button class="btn" id="resetBtn">Reset</button>
        </div>

        <div class="envelope" id="envelope">
          <p class="envelopeTitle">One last thing</p>
          <p class="envelopeText" id="envelopeText">
            Hey, I love you so much!!!
          </p>
          <div class="actions" style="margin-top:12px">
            <button class="btn primary" id="yesBtn">Yes</button>
            <button class="btn" id="copyBtn">Copy message</button>
          </div>
        </div>
      </aside>
    </div>
  </div>

  <div class="toast" id="toast">Copied</div>

  <div class="modalBackdrop" id="modalBackdrop" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal">
      <div class="modalHeader">
        <p class="modalTitle" id="modalTitle">Copy this message</p>
        <button class="modalClose" id="modalClose" type="button">Close</button>
      </div>
      <p class="modalHint">
        If one click copy is blocked on this site, select the text below and copy with Cmd+C or Ctrl+C.
      </p>
      <textarea class="copyArea" id="copyArea" readonly></textarea>
      <div class="actions" style="justify-content:flex-end; margin-top:10px">
        <button class="btn" id="selectAllBtn">Select all</button>
        <button class="btn primary" id="tryCopyBtn">Try copy again</button>
      </div>
    </div>
  </div>

<script>
  const photos = [
    {
      src: "images/IMG_0363.JPG",
      title: "That airport hug",
      caption: "The kind of calm that only you can do.",
      stamp: "moment 01"
    },
    {
      src: "images/IMG_1139.JPG",
      title: "Lake day",
      caption: "Sun, water, and you looking at me like that.",
      stamp: "moment 02"
    },
    {
      src: "images/IMG_4146.JPG",
      title: "City lights",
      caption: "You, me, and a street that looked like a movie set.",
      stamp: "moment 03"
    },
    {
      src: "images/IMG_4367.JPG",
      title: "Soft morning",
      caption: "I like how easy it feels to be close to you.",
      stamp: "moment 04"
    },
    {
      src: "images/IMG_5422%202.JPG",
      title: "Under the dome",
      caption: "I remember this exact feeling. Quiet and perfect.",
      stamp: "moment 05"
    },
    {
      src: "images/IMG_5582.JPG",
      title: "Christmas",
      caption: "The look we do when we both know we are happy.",
      stamp: "moment 06"
    },
    {
      src: "images/IMG_6013.JPG",
      title: "Too close",
      caption: "Proof that you make me smile without trying.",
      stamp: "moment 07"
    },
    {
      src: "images/IMG_9716.JPG",
      title: "A small gift",
      caption: "I love how you show up in my life with warmth.",
      stamp: "moment 08"
    }
  ];

  const LOVE_MESSAGE =
    "Soline, I love you. You are the best thing and feeling that happened to me in 2025. " +
    "You cross my mind in the most random moments and suddenly everything feels softer. " +
    "I smile like an idiot and I know exactly why. Even when the day is chaotic, the thought of you brings a calm I cannot explain. " +
    "You feel like home. I trust you and I love you.";

  const table = document.getElementById("table");
  const counter = document.getElementById("counter");
  const envelope = document.getElementById("envelope");
  const shuffleBtn = document.getElementById("shuffleBtn");
  const flipAllBtn = document.getElementById("flipAllBtn");
  const resetBtn = document.getElementById("resetBtn");
  const yesBtn = document.getElementById("yesBtn");
  const copyBtn = document.getElementById("copyBtn");
  const toast = document.getElementById("toast");
  const a11y = document.getElementById("a11y");

  const modalBackdrop = document.getElementById("modalBackdrop");
  const modalClose = document.getElementById("modalClose");
  const copyArea = document.getElementById("copyArea");
  const selectAllBtn = document.getElementById("selectAllBtn");
  const tryCopyBtn = document.getElementById("tryCopyBtn");

  let flippedSet = new Set();
  let topZ = 10;

  function rand(min, max){ return Math.random() * (max - min) + min; }

  function showToast(text){
    toast.textContent = text;
    toast.classList.add("show");
    clearTimeout(showToast.t);
    showToast.t = setTimeout(()=> toast.classList.remove("show"), 900);
  }

  function updateCounter(){
    const n = flippedSet.size;
    counter.textContent = `${n} of ${photos.length} flipped`;
    if(n === photos.length){
      envelope.classList.add("show");
      a11y.textContent = "All photos flipped. Envelope unlocked.";
    } else {
      envelope.classList.remove("show");
    }
  }

  function placePolaroid(el){
    const rect = table.getBoundingClientRect();
    const pad = 40;

    const x = rand(pad, Math.max(pad, rect.width - 240 - pad));
    const y = rand(pad, Math.max(pad, rect.height - 300 - pad));
    const r = rand(-10, 10);

    el.style.left = x + "px";
    el.style.top = y + "px";
    el.style.transform = `rotate(${r}deg)`;
  }

  function build(){
    table.querySelectorAll(".polaroid").forEach(n => n.remove());
    flippedSet = new Set();
    topZ = 10;

    photos.forEach((p, i) => {
      const card = document.createElement("div");
      card.className = "polaroid";
      card.dataset.id = String(i);
      card.style.zIndex = String(topZ++);

      const inner = document.createElement("div");
      inner.className = "polaroidInner";

      const front = document.createElement("div");
      front.className = "face front";
      front.innerHTML = `
        <div class="photoFrame">
          <img src="${p.src}" alt="Photo ${i + 1}" loading="lazy" />
        </div>
        <div class="scribble">
          <span>${p.title}</span>
          <span class="stamp">${p.stamp}</span>
        </div>
        <p class="tapHint">click to flip</p>
      `;

      const back = document.createElement("div");
      back.className = "face back";
      back.innerHTML = `
        <div class="backTop">
          <span>${p.title}</span>
          <span class="heartDot">‚ù§</span>
        </div>
        <p class="caption">${p.caption}</p>
        <p class="note">click again to go back</p>
      `;

      inner.appendChild(front);
      inner.appendChild(back);
      card.appendChild(inner);
      table.appendChild(card);

      placePolaroid(card);

      card.addEventListener("click", () => {
        card.style.zIndex = String(topZ++);
        card.classList.toggle("isFlipped");

        const id = Number(card.dataset.id);
        if(card.classList.contains("isFlipped")){
          flippedSet.add(id);
          a11y.textContent = `Flipped photo ${id + 1}.`;
        } else {
          a11y.textContent = `Returned photo ${id + 1}.`;
        }
        updateCounter();
      });
    });

    updateCounter();
    envelope.classList.remove("show");
  }

  function shuffle(){
    document.querySelectorAll(".polaroid").forEach(el => {
      el.style.zIndex = String(topZ++);
      placePolaroid(el);
    });
    showToast("Shuffled");
  }

  function flipAll(){
    document.querySelectorAll(".polaroid").forEach(el => {
      if(!el.classList.contains("isFlipped")) el.classList.add("isFlipped");
      flippedSet.add(Number(el.dataset.id));
    });
    updateCounter();
    showToast("All flipped");
  }

  function reset(){
    document.querySelectorAll(".polaroid").forEach(el => el.classList.remove("isFlipped"));
    flippedSet = new Set();
    envelope.classList.remove("show");
    updateCounter();
    showToast("Reset");
    a11y.textContent = "Reset.";
  }

  async function tryClipboardWrite(text){
    if(!navigator.clipboard || typeof navigator.clipboard.writeText !== "function"){
      return { ok:false };
    }
    try{
      await navigator.clipboard.writeText(text);
      return { ok:true };
    } catch {
      return { ok:false };
    }
  }

  function legacyCopy(text){
    const ta = document.createElement("textarea");
    ta.value = text;
    ta.setAttribute("readonly","");
    ta.style.position = "fixed";
    ta.style.top = "-1000px";
    ta.style.left = "-1000px";
    document.body.appendChild(ta);
    ta.focus();
    ta.select();
    let ok = false;
    try { ok = document.execCommand && document.execCommand("copy"); } catch { ok = false; }
    document.body.removeChild(ta);
    return ok;
  }

  function openCopyModal(){
    copyArea.value = LOVE_MESSAGE;
    modalBackdrop.classList.add("show");
    setTimeout(() => { copyArea.focus(); copyArea.select(); }, 0);
  }

  function closeCopyModal(){
    modalBackdrop.classList.remove("show");
    copyBtn.focus();
  }

  modalClose.addEventListener("click", closeCopyModal);
  modalBackdrop.addEventListener("click", (e) => { if(e.target === modalBackdrop) closeCopyModal(); });
  document.addEventListener("keydown", (e) => { if(e.key === "Escape" && modalBackdrop.classList.contains("show")) closeCopyModal(); });

  selectAllBtn.addEventListener("click", () => { copyArea.focus(); copyArea.select(); });
  tryCopyBtn.addEventListener("click", async () => {
    const r = await tryClipboardWrite(copyArea.value);
    if(r.ok){ showToast("Copied"); closeCopyModal(); return; }
    const ok = legacyCopy(copyArea.value);
    if(ok){ showToast("Copied"); closeCopyModal(); return; }
    showToast("Copy manually");
  });

  shuffleBtn.addEventListener("click", shuffle);
  flipAllBtn.addEventListener("click", flipAll);
  resetBtn.addEventListener("click", reset);

  yesBtn.addEventListener("click", () => {
    showToast("Yay");
    alert("You just made my whole day, Soline.");
  });

  copyBtn.addEventListener("click", async () => {
    const r = await tryClipboardWrite(LOVE_MESSAGE);
    if(r.ok){ showToast("Copied"); return; }
    const ok = legacyCopy(LOVE_MESSAGE);
    if(ok){ showToast("Copied"); return; }
    openCopyModal();
  });

  build();
</script>
</body>
</html>
