<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>For Soline</title>
  <style>
    :root {
      --ink: #f3f4ff;
      --muted: rgba(243, 244, 255, .72);

      --glass: rgba(255, 255, 255, .07);
      --glass2: rgba(255, 255, 255, .10);
      --line: rgba(255, 255, 255, .14);

      --shadow: 0 26px 80px rgba(0, 0, 0, .42);
      --shadow2: 0 14px 30px rgba(0, 0, 0, .40);

      --accent: #a855f7;
      --accent2: #22d3ee;
      --accent3: #f472b6;

      --gardenTop: #050411;
      --gardenMid: #090822;
      --gardenBot: #050414;

      --leaf1: #32d27a;
      --leaf2: #1a8f5a;
    }

    * {
      box-sizing: border-box
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--ink);
      background:
        radial-gradient(900px 520px at 18% 16%, rgba(168, 85, 247, .22), transparent 55%),
        radial-gradient(900px 520px at 78% 20%, rgba(34, 211, 238, .18), transparent 55%),
        radial-gradient(1200px 820px at 50% 80%, rgba(244, 114, 182, .12), transparent 62%),
        linear-gradient(180deg, #02010a, #06041a 40%, #02010a 100%);
      overflow: hidden;
    }

    .wrap {
      min-height: 100vh;
      display: grid;
      place-items: center;
      padding: 18px;
      position: relative;
    }

    .shell {
      width: min(980px, 96vw);
      display: grid;
      grid-template-columns: 380px 1fr;
      gap: 16px;
      align-items: stretch;
    }

    @media (max-width: 980px) {
      body {
        overflow: auto
      }

      .shell {
        grid-template-columns: 1fr
      }
    }

    .panel {
      border-radius: 26px;
      background: linear-gradient(180deg, rgba(255, 255, 255, .08), rgba(255, 255, 255, .05));
      backdrop-filter: blur(12px);
      border: 1px solid var(--line);
      box-shadow: var(--shadow);
      padding: 16px;
    }

    h1 {
      margin: 0;
      font-size: clamp(26px, 3.2vw, 38px);
      letter-spacing: .2px;
    }

    p {
      margin: 10px 0 0 0;
      color: var(--muted);
      line-height: 1.45;
      font-size: 14px;
    }

    .statRow {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 14px;
      align-items: center;
    }

    .pill {
      background: rgba(255, 255, 255, .10);
      border: 1px solid rgba(255, 255, 255, .14);
      border-radius: 999px;
      padding: 10px 12px;
      font-weight: 820;
      box-shadow: var(--shadow2);
      user-select: none;
    }

    .btn {
      border: 0;
      border-radius: 999px;
      padding: 10px 12px;
      font-weight: 850;
      cursor: pointer;
      background: rgba(255, 255, 255, .10);
      color: var(--ink);
      border: 1px solid rgba(255, 255, 255, .14);
      box-shadow: var(--shadow2);
      transition: transform .12s ease, filter .12s ease;
    }

    .btn:hover {
      filter: brightness(1.05);
    }

    .btn:active {
      transform: translateY(1px);
    }

    .primary {
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: #071021;
      border: 0;
      box-shadow: 0 18px 44px rgba(168, 85, 247, .22), 0 18px 44px rgba(34, 211, 238, .12);
    }

    .garden {
      border-radius: 26px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(255, 255, 255, .14);
      overflow: hidden;
      position: relative;
      min-height: 640px;
      background:
        radial-gradient(1000px 620px at 30% 0%, rgba(168, 85, 247, .18), transparent 58%),
        radial-gradient(1000px 620px at 80% 10%, rgba(34, 211, 238, .12), transparent 58%),
        radial-gradient(800px 520px at 45% 80%, rgba(244, 114, 182, .10), transparent 62%),
        linear-gradient(180deg, var(--gardenTop), var(--gardenMid) 45%, var(--gardenBot));
    }

    .nebula {
      position: absolute;
      inset: -20%;
      background:
        radial-gradient(circle at 20% 30%, rgba(168, 85, 247, .10), transparent 45%),
        radial-gradient(circle at 70% 20%, rgba(34, 211, 238, .08), transparent 45%),
        radial-gradient(circle at 55% 75%, rgba(244, 114, 182, .06), transparent 50%);
      filter: blur(6px);
      opacity: .95;
      pointer-events: none;
    }

    .stars {
      position: absolute;
      inset: 0;
      background-image:
        radial-gradient(1px 1px at 10% 20%, rgba(255, 255, 255, .65) 50%, transparent 52%),
        radial-gradient(1px 1px at 30% 40%, rgba(255, 255, 255, .55) 50%, transparent 52%),
        radial-gradient(1px 1px at 65% 18%, rgba(255, 255, 255, .55) 50%, transparent 52%),
        radial-gradient(1px 1px at 80% 35%, rgba(255, 255, 255, .62) 50%, transparent 52%),
        radial-gradient(1px 1px at 55% 55%, rgba(255, 255, 255, .40) 50%, transparent 52%),
        radial-gradient(1px 1px at 20% 70%, rgba(255, 255, 255, .45) 50%, transparent 52%),
        radial-gradient(1px 1px at 75% 75%, rgba(255, 255, 255, .35) 50%, transparent 52%),
        radial-gradient(1px 1px at 45% 25%, rgba(255, 255, 255, .38) 50%, transparent 52%);
      opacity: .55;
      pointer-events: none;
      mix-blend-mode: screen;
    }

    .vignette {
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 50% 35%, transparent 35%, rgba(0, 0, 0, .48) 92%);
      pointer-events: none;
      opacity: .8;
    }

    .hint {
      position: absolute;
      left: 14px;
      top: 14px;
      background: rgba(255, 255, 255, .10);
      border: 1px solid rgba(255, 255, 255, .14);
      border-radius: 999px;
      padding: 10px 12px;
      font-weight: 820;
      box-shadow: var(--shadow2);
      user-select: none;
    }

    /* --- Geometric Vector Styles --- */

    .flower {
      position: absolute;
      width: 0;
      height: 0;
      transform: translate(-50%, -50%);
      pointer-events: none;
      z-index: 10;
      visibility: hidden;
    }

    .bloomWrapper {
      position: absolute;
      left: 0;
      top: 0;
      width: 0;
      height: 0;
      /* Elastic pop */
      animation: bloomPop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    }

    @keyframes bloomPop {
      0% {
        transform: scale(0);
      }

      100% {
        transform: scale(1);
      }
    }

    /* Common geometric elements */
    .geo-part {
      position: absolute;
      left: 0;
      top: 0;
    }

    /* Type 3: Round Abstract */
    .round-layer {
      position: absolute;
      border-radius: 50%;
      transform: translate(-50%, -50%);
    }

    /* Leaves (geometric triangles) */
    .geo-leaf {
      position: absolute;
      width: 0;
      height: 0;
      border-left: 10px solid transparent;
      border-right: 10px solid transparent;
      border-bottom: 20px solid #808000;
      /* Olive */
      transform-origin: 50% 100%;
    }

    .stemPath {
      fill: none;
      stroke-width: 4;
      stroke-linecap: square;
      /* boxy ends */
      opacity: 1;
    }

    .sparkles {
      position: absolute;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
    }

    .sparkle {
      position: absolute;
      font-size: 16px;
      opacity: 0;
      animation: floatUp linear forwards;
      filter: drop-shadow(0 0 16px rgba(34, 211, 238, .22));
    }

    @keyframes floatUp {
      0% {
        transform: translate(-50%, -50%) translateY(10px) scale(.9);
        opacity: 0;
      }

      10% {
        opacity: .95;
      }

      100% {
        transform: translate(-50%, -50%) translateY(-120vh) scale(1.25);
        opacity: 0;
      }
    }

    .toast {
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(8, 10, 22, .88);
      border: 1px solid rgba(255, 255, 255, .14);
      color: #fff;
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 13px;
      opacity: 0;
      pointer-events: none;
      transition: opacity .22s ease, transform .22s ease;
      z-index: 30;
      box-shadow: var(--shadow2);
    }

    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(-6px);
    }

    .modalBackdrop {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 18px;
      background: rgba(0, 0, 0, .40);
      z-index: 60;
    }

    .modalBackdrop.show {
      display: flex;
    }

    .modal {
      width: min(640px, 96vw);
      background: linear-gradient(180deg, rgba(255, 255, 255, .12), rgba(255, 255, 255, .07));
      backdrop-filter: blur(14px);
      border: 1px solid rgba(255, 255, 255, .16);
      border-radius: 26px;
      box-shadow: 0 30px 110px rgba(0, 0, 0, .55);
      padding: 18px;
      position: relative;
      overflow: hidden;
    }

    .modal::before {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        radial-gradient(circle at 20% 30%, rgba(168, 85, 247, .18), transparent 45%),
        radial-gradient(circle at 70% 20%, rgba(34, 211, 238, .16), transparent 45%),
        radial-gradient(circle at 55% 75%, rgba(244, 114, 182, .12), transparent 50%);
      filter: blur(18px);
      opacity: .9;
      pointer-events: none;
    }

    .modalTop {
      position: relative;
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
    }

    .big {
      margin: 0;
      font-size: clamp(22px, 2.6vw, 30px);
      letter-spacing: .2px;
      font-weight: 950;
    }

    .close {
      border-radius: 999px;
      padding: 10px 12px;
      font-weight: 850;
      border: 1px solid rgba(255, 255, 255, .16);
      background: rgba(255, 255, 255, .10);
      color: var(--ink);
      cursor: pointer;
    }

    .message {
      position: relative;
      margin: 10px 0 0 0;
      color: rgba(243, 244, 255, .86);
      font-size: 15px;
      line-height: 1.55;
      font-weight: 720;
    }

    .cute {
      position: relative;
      margin-top: 12px;
      border-radius: 20px;
      padding: 14px;
      background: rgba(255, 255, 255, .08);
      border: 1px solid rgba(255, 255, 255, .14);
      overflow: hidden;
      min-height: 130px;
    }

    .flowerIcon {
      width: 72px;
      height: 72px;
      border-radius: 20px;
      display: grid;
      place-items: center;
      background: linear-gradient(135deg, rgba(168, 85, 247, .22), rgba(34, 211, 238, .16));
      border: 1px solid rgba(255, 255, 255, .14);
      box-shadow: 0 18px 44px rgba(168, 85, 247, .20), 0 18px 44px rgba(34, 211, 238, .12);
      margin-bottom: 10px;
      animation: bob 1.6s ease-in-out infinite;
    }

    .flowerIcon span {
      font-size: 38px;
    }

    @keyframes bob {

      0%,
      100% {
        transform: translateY(0px);
      }

      50% {
        transform: translateY(-6px);
      }
    }

    .heartBurst {
      position: absolute;
      inset: 0;
      pointer-events: none;
    }

    .h {
      position: absolute;
      font-size: 18px;
      opacity: 0;
      animation: hearts 1.9s ease-in-out infinite;
      filter: drop-shadow(0 0 16px rgba(244, 114, 182, .20));
    }

    @keyframes hearts {
      0% {
        transform: translateY(20px) scale(.85);
        opacity: 0;
      }

      35% {
        opacity: .95;
      }

      100% {
        transform: translateY(-170px) scale(1.18);
        opacity: 0;
      }
    }

    .srOnly {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="shell">
      <section class="panel">
        <h1>Make flowers for Soline</h1>
        <p>
          Click inside the cosmic garden to plant a flower. After 20 flowers, a surprise opens.
        </p>

        <div class="statRow">
          <div class="pill" id="countPill">0 of 20 flowers</div>
          <button class="btn" id="randomBtn" type="button">Random palette</button>
          <button class="btn" id="resetBtn" type="button">Reset</button>
        </div>

        <p style="margin-top:14px">
          Tip: spread them out. The garden looks prettier when it fills the corners too.
        </p>
      </section>

      <section class="garden" id="garden" aria-live="polite">
        <div class="nebula"></div>
        <div class="stars"></div>
        <div class="vignette"></div>

        <!-- SVG Layer for Stems -->
        <svg id="stems"
          style="position:absolute; inset:0; pointer-events:none; width:100%; height:100%; overflow:visible; z-index:1"></svg>

        <div class="hint" id="hint">click to plant</div>
        <div class="sparkles" id="sparkles"></div>

        <span class="srOnly" id="a11y"></span>
      </section>
    </div>
  </div>

  <div class="toast" id="toast">Surprise unlocked</div>

  <div class="modalBackdrop" id="modalBackdrop" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal">
      <div class="modalTop">
        <div>
          <p class="big" id="modalTitle">You did it</p>
          <p class="message">Happy 3rd day of the love month, Soline.</p>
        </div>
        <button class="close" id="closeBtn" type="button">Close</button>
      </div>

      <div class="cute">
        <div class="flowerIcon"><span>ðŸŒ·</span></div>
        <div style="position:relative; font-weight:900; letter-spacing:.2px">A small galaxy of flowers</div>
        <div style="position:relative; margin-top:8px; color:rgba(243,244,255,.78); line-height:1.45">
          Twenty flowers, twenty tiny reasons I smile when I think of you.
        </div>
        <div class="heartBurst" id="heartBurst"></div>
      </div>

      <div style="position:relative; display:flex; gap:10px; justify-content:flex-end; margin-top:14px; flex-wrap:wrap">
        <button class="btn" id="againBtn" type="button">Make more flowers</button>
        <button class="btn primary" id="okBtn" type="button">Aww</button>
      </div>
    </div>
  </div>

  <script>
    const garden = document.getElementById("garden");
    const countPill = document.getElementById("countPill");
    const resetBtn = document.getElementById("resetBtn");
    const randomBtn = document.getElementById("randomBtn");
    const hint = document.getElementById("hint");
    const toast = document.getElementById("toast");
    const sparkles = document.getElementById("sparkles");
    const stems = document.getElementById("stems");
    const a11y = document.getElementById("a11y");

    const modalBackdrop = document.getElementById("modalBackdrop");
    const closeBtn = document.getElementById("closeBtn");
    const againBtn = document.getElementById("againBtn");
    const okBtn = document.getElementById("okBtn");
    const heartBurst = document.getElementById("heartBurst");

    const TARGET = 20;

    let count = 0;
    let unlocked = false;

    // Geometric Palette from reference
    const geoPalette = {
      orange: "#ff6b4a",
      pink: "#ff8fab",
      black: "#1a1a1a",
      olive: "#808000",
      blue: "#a5f3fc"
    };

    // Helper to get random color from specific set
    function getGeoColor() {
      return pick([geoPalette.orange, geoPalette.pink, geoPalette.blue]);
    }

    function rand(min, max) { return Math.random() * (max - min) + min; }
    function pick(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

    function showToast(text) {
      toast.textContent = text;
      toast.classList.add("show");
      clearTimeout(showToast.t);
      showToast.t = setTimeout(() => toast.classList.remove("show"), 950);
    }

    function updateCount() {
      const n = Math.min(count, TARGET);
      countPill.textContent = `${n} of ${TARGET} flowers`;
      if (count >= TARGET && !unlocked) {
        unlocked = true;
        openModal();
        showToast("Surprise unlocked");
        a11y.textContent = "Surprise unlocked.";
      }
    }

    function makeFlower(x, y) {
      // 1. Calculate Start Point (bottom random)
      // Pure random X from 0 to width ensures no bias
      const startX = rand(0, window.innerWidth);
      const startY = window.innerHeight;
      const endX = x;
      const endY = y;

      // 2. Create SVG Path for Stem
      const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
      path.setAttribute("class", "stemPath");

      // Control points for a "growing up" curve
      // To feel "from bottom", we ensure CP1 is relatively low
      const midY = (startY + endY) * 0.55;
      // X variance based on distance to add organic feel but not bias
      const drift = (endX - startX) * 0.3;
      const midX = (startX + endX) / 2 + rand(-30, 30);

      const d = `M${startX},${startY} Q${midX},${midY} ${endX},${endY}`;
      path.setAttribute("d", d);

      // Color: Olive
      path.style.stroke = geoPalette.olive;

      // Animation: Length
      const len = Math.floor(Math.sqrt((endX - startX) ** 2 + (endY - startY) ** 2) * 1.5);
      path.style.strokeDasharray = len;
      path.style.strokeDashoffset = len;

      // Fast, snappy growth
      const duration = rand(0.5, 0.8);
      path.style.transition = `stroke-dashoffset ${duration}s ease-out`;

      stems.appendChild(path);

      // Trigger Stem Animation
      requestAnimationFrame(() => {
        path.style.strokeDashoffset = "0";
      });

      // Add Geometric Leaves (Triangles)
      const leafCount = rand(1, 3);
      for (let i = 0; i < leafCount; i++) {
        const leaf = document.createElement("div");
        leaf.className = "geo-leaf";
        const progress = rand(0.2, 0.8);

        // Linear mix
        const lx = startX + (endX - startX) * progress;
        const ly = startY + (endY - startY) * progress;
        // Add curve offset approximation (simple quadratic for leaves is hard without math, linear is safer)

        leaf.style.left = lx + "px";
        leaf.style.top = ly + "px";

        const scaleX = Math.random() > 0.5 ? 1 : -1;
        leaf.style.transform = `translate(-50%, 0) scaleX(${scaleX}) rotate(${rand(-15, 15)}deg)`;

        leaf.style.opacity = "0";
        leaf.style.transition = `opacity 0.2s ease-out ${duration * progress}s`;

        document.getElementById("garden").appendChild(leaf);

        requestAnimationFrame(() => leaf.style.opacity = "1");
      }

      // 3. Create Bloom
      setTimeout(() => {
        createGeoBloom(endX, endY);
      }, duration * 1000 * 0.85);
    }

    function createGeoBloom(x, y) {
      const flower = document.createElement("div");
      flower.className = "flower";
      flower.style.left = x + "px";
      flower.style.top = y + "px";
      flower.style.visibility = "visible";

      const wrapper = document.createElement("div");
      wrapper.className = "bloomWrapper";
      flower.appendChild(wrapper);

      // --- Round Abstract Only (Circular) ---
      // We will generate random concentric circles for variety

      // Ring 1 (Outer)
      const l1 = document.createElement("div");
      l1.className = "round-layer";
      const s1 = rand(40, 52);
      l1.style.width = s1 + "px";
      l1.style.height = s1 + "px";
      l1.style.background = getGeoColor();
      wrapper.appendChild(l1);

      // Ring 2 (Mid)
      const l2 = document.createElement("div");
      l2.className = "round-layer";
      const s2 = s1 * rand(0.6, 0.75);
      l2.style.width = s2 + "px";
      l2.style.height = s2 + "px";
      l2.style.background = getGeoColor(); // allow same or diff color
      wrapper.appendChild(l2);

      // Ring 3 (Inner)
      const l3 = document.createElement("div");
      l3.className = "round-layer";
      const s3 = s2 * rand(0.4, 0.6);
      l3.style.width = s3 + "px";
      l3.style.height = s3 + "px";
      l3.style.background = pick([geoPalette.black, geoPalette.blue]);
      wrapper.appendChild(l3);

      // Center (Diamond/Dot)
      const l4 = document.createElement("div");
      l4.className = "round-layer";
      const s4 = s3 * 0.4;
      l4.style.width = s4 + "px";
      l4.style.height = s4 + "px";

      // Randomly diamond or circle
      if (Math.random() > 0.5) {
        l4.style.borderRadius = "0";
        l4.style.transform = "translate(-50%, -50%) rotate(45deg)";
      }
      l4.style.background = "#fff";
      wrapper.appendChild(l4);

      garden.appendChild(flower);
    }

    function sparkleAt(x, y) {
      const s = document.createElement("div");
      s.className = "sparkle";
      s.textContent = pick(["âœ¨", "ðŸ’—", "ðŸ’–", "ðŸ’˜", "âœ¦", "âœ§", "âœ¨"]);
      s.style.left = x + "px";
      s.style.top = y + "px";
      s.style.fontSize = Math.floor(rand(14, 26)) + "px";
      s.style.animationDuration = rand(2.6, 5.2) + "s";
      sparkles.appendChild(s);
      setTimeout(() => s.remove(), 5600);
    }

    function openModal() {
      modalBackdrop.classList.add("show");
      buildHearts();
    }

    function closeModal() {
      modalBackdrop.classList.remove("show");
      heartBurst.innerHTML = "";
    }

    function buildHearts() {
      heartBurst.innerHTML = "";
      const n = 18;
      for (let i = 0; i < n; i++) {
        const h = document.createElement("div");
        h.className = "h";
        h.textContent = pick(["â¤", "ðŸ’—", "ðŸ’–", "ðŸ’˜", "ðŸ’•"]);
        h.style.left = rand(0, 100) + "%";
        h.style.bottom = "-10px";
        h.style.animationDelay = rand(0, 1.2) + "s";
        h.style.fontSize = Math.floor(rand(16, 26)) + "px";
        heartBurst.appendChild(h);
      }
    }

    function reset() {
      [...garden.querySelectorAll(".flower")].forEach(n => n.remove());
      count = 0;
      unlocked = false;
      updateCount();
      showToast("Reset");
      hint.textContent = "click to plant";
    }

    // setRandomPalette removed

    garden.addEventListener("click", (e) => {
      const rect = garden.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;

      makeFlower(x, y);
      sparkleAt(x, y);

      count += 1;
      hint.textContent = count < TARGET ? "keep going" : "surprise time";
      updateCount();
    });

    resetBtn.addEventListener("click", reset);
    // randomBtn removed as we use a fixed geometric palette now
    if (randomBtn) randomBtn.style.display = "none";

    closeBtn.addEventListener("click", closeModal);
    okBtn.addEventListener("click", closeModal);
    againBtn.addEventListener("click", () => {
      closeModal();
      showToast("More flowers");
    });

    modalBackdrop.addEventListener("click", (e) => {
      if (e.target === modalBackdrop) closeModal();
    });

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && modalBackdrop.classList.contains("show")) closeModal();
    });

    updateCount();
  </script>
</body>

</html>