<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chocolate Delivery Across the World</title>
  <style>
    :root {
      --bg0: #0b0706;
      --bg1: #140b08;
      --choco: #2a1410;
      --choco2: #3a1d16;
      --cream: #f6eadf;
      --cream2: #d9c7bb;
      --gold: #e2b24b;
      --rose: #ff6b86;
      --mint: #7bf2c9;
      --shadow: rgba(0, 0, 0, .45);
      --glass: rgba(255, 255, 255, .06);
      --glass2: rgba(255, 255, 255, .10);
      --line: rgba(226, 178, 75, .55);
      --line2: rgba(226, 178, 75, .25);
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
    }

    body {
      margin: 0;
      color: var(--cream);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background:
        radial-gradient(1200px 700px at 20% 15%, rgba(226, 178, 75, .10), transparent 55%),
        radial-gradient(900px 600px at 85% 25%, rgba(255, 107, 134, .10), transparent 55%),
        radial-gradient(1100px 800px at 40% 95%, rgba(123, 242, 201, .06), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x: hidden;
    }

    .wrap {
      max-width: 1100px;
      margin: 0 auto;
      padding: 28px 18px 60px;
    }

    header {
      display: flex;
      gap: 16px;
      align-items: flex-start;
      justify-content: space-between;
      flex-wrap: wrap;
      margin-bottom: 18px;
    }

    .titleBlock {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .kicker {
      font-size: 13px;
      letter-spacing: .18em;
      text-transform: uppercase;
      color: var(--cream2);
      opacity: .95;
    }

    h1 {
      margin: 0;
      font-size: clamp(26px, 3.2vw, 44px);
      line-height: 1.07;
      letter-spacing: -0.02em;
    }

    .subtitle {
      margin: 0;
      color: var(--cream2);
      max-width: 62ch;
      font-size: 15px;
      line-height: 1.6;
      opacity: .95;
    }

    .pillRow {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
      justify-content: flex-end;
      margin-top: 4px;
    }

    .pill {
      background: linear-gradient(180deg, rgba(255, 255, 255, .08), rgba(255, 255, 255, .03));
      border: 1px solid rgba(255, 255, 255, .14);
      box-shadow: 0 10px 30px var(--shadow);
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 13px;
      color: var(--cream2);
      display: flex;
      gap: 8px;
      align-items: center;
      user-select: none;
    }

    .pill strong {
      color: var(--cream);
      font-weight: 650;
    }

    .btn {
      cursor: pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }

    .btn:hover {
      transform: translateY(-1px);
      border-color: rgba(226, 178, 75, .45);
    }

    .btn:active {
      transform: translateY(0px) scale(.99);
    }

    .card {
      border-radius: 22px;
      background: linear-gradient(180deg, rgba(255, 255, 255, .08), rgba(255, 255, 255, .03));
      border: 1px solid rgba(255, 255, 255, .14);
      box-shadow: 0 18px 60px var(--shadow);
      overflow: hidden;
      position: relative;
    }

    .panel {
      display: grid;
      grid-template-columns: 1.15fr .85fr;
      gap: 16px;
      padding: 16px;
    }

    @media (max-width: 920px) {
      .panel {
        grid-template-columns: 1fr;
      }
    }

    .mapArea {
      position: relative;
      min-height: 520px;
      padding: 14px;
      border-radius: 18px;
      background:
        radial-gradient(800px 520px at 30% 20%, rgba(226, 178, 75, .09), transparent 60%),
        radial-gradient(700px 520px at 80% 70%, rgba(255, 107, 134, .08), transparent 60%),
        linear-gradient(180deg, rgba(0, 0, 0, .18), rgba(0, 0, 0, .32));
      border: 1px solid rgba(255, 255, 255, .10);
      overflow: hidden;
    }

    .mapGrid {
      position: absolute;
      inset: 0;
      background:
        linear-gradient(to right, rgba(255, 255, 255, .04) 1px, transparent 1px) 0 0/42px 42px,
        linear-gradient(to bottom, rgba(255, 255, 255, .04) 1px, transparent 1px) 0 0/42px 42px;
      opacity: .45;
      pointer-events: none;
    }

    .terrain {
      position: absolute;
      inset: -2px;
      opacity: .85;
      pointer-events: none;
      filter: drop-shadow(0 18px 30px rgba(0, 0, 0, .45));
    }

    .terrain svg {
      width: 100%;
      height: 100%;
      display: block;
    }

    .routeLayer {
      position: absolute;
      inset: 0;
      pointer-events: none;
    }

    .pin {
      position: absolute;
      transform: translate(-50%, -100%);
      display: flex;
      flex-direction: column;
      gap: 6px;
      align-items: center;
      pointer-events: none;
    }

    .pinTop {
      width: 38px;
      height: 38px;
      border-radius: 999px;
      display: grid;
      place-items: center;
      background: linear-gradient(180deg, rgba(255, 255, 255, .14), rgba(255, 255, 255, .05));
      border: 1px solid rgba(255, 255, 255, .16);
      box-shadow: 0 12px 30px rgba(0, 0, 0, .35);
    }

    .pinDot {
      width: 12px;
      height: 12px;
      border-radius: 999px;
      background: var(--gold);
      box-shadow: 0 0 0 6px rgba(226, 178, 75, .22), 0 0 18px rgba(226, 178, 75, .22);
    }

    .pinLabel {
      font-size: 12px;
      color: var(--cream2);
      background: rgba(0, 0, 0, .26);
      border: 1px solid rgba(255, 255, 255, .12);
      padding: 6px 10px;
      border-radius: 999px;
      white-space: nowrap;
    }

    .checkpoint {
      position: absolute;
      transform: translate(-50%, -50%);
      width: 14px;
      height: 14px;
      border-radius: 999px;
      background: rgba(255, 255, 255, .14);
      border: 1px solid rgba(255, 255, 255, .25);
      box-shadow: 0 0 0 6px rgba(255, 255, 255, .06);
      pointer-events: none;
      opacity: .85;
    }

    .checkpoint.active {
      background: var(--rose);
      border-color: rgba(255, 255, 255, .35);
      box-shadow: 0 0 0 7px rgba(255, 107, 134, .20), 0 0 20px rgba(255, 107, 134, .22);
      opacity: 1;
    }

    .parcel {
      position: absolute;
      width: 56px;
      height: 56px;
      transform: translate(-50%, -50%);
      z-index: 5;
      display: grid;
      place-items: center;
      filter: drop-shadow(0 16px 22px rgba(0, 0, 0, .45));
    }

    .parcelBubble {
      position: absolute;
      top: -48px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, .28);
      border: 1px solid rgba(255, 255, 255, .14);
      padding: 8px 10px;
      border-radius: 14px;
      font-size: 12px;
      color: var(--cream2);
      white-space: nowrap;
      opacity: 0;
      transition: opacity .25s ease, transform .25s ease;
      pointer-events: none;
    }

    .parcelBubble.show {
      opacity: 1;
      transform: translateX(-50%) translateY(-2px);
    }

    .parcel svg {
      width: 56px;
      height: 56px;
    }

    .side {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .sideCard {
      padding: 14px;
      border-radius: 18px;
      background: rgba(0, 0, 0, .22);
      border: 1px solid rgba(255, 255, 255, .10);
    }

    .side h2 {
      margin: 0 0 6px 0;
      font-size: 16px;
      letter-spacing: .01em;
    }

    .side p {
      margin: 0;
      color: var(--cream2);
      font-size: 14px;
      line-height: 1.65;
    }

    .progressWrap {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 10px;
    }

    .bar {
      height: 12px;
      border-radius: 999px;
      background: rgba(255, 255, 255, .08);
      border: 1px solid rgba(255, 255, 255, .12);
      overflow: hidden;
    }

    .bar>div {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, rgba(226, 178, 75, .95), rgba(255, 107, 134, .85));
      border-radius: 999px;
      transition: width .35s ease;
    }

    .metaRow {
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: space-between;
      color: var(--cream2);
      font-size: 13px;
    }

    .controls {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 12px;
    }

    .controlBtn {
      flex: 1 1 auto;
      min-width: 140px;
      background: linear-gradient(180deg, rgba(226, 178, 75, .18), rgba(226, 178, 75, .06));
      border: 1px solid rgba(226, 178, 75, .28);
      color: var(--cream);
      padding: 12px 12px;
      border-radius: 14px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, .35);
      font-weight: 650;
      letter-spacing: .01em;
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: center;
    }

    .controlBtn.secondary {
      background: linear-gradient(180deg, rgba(255, 255, 255, .08), rgba(255, 255, 255, .03));
      border: 1px solid rgba(255, 255, 255, .16);
      color: var(--cream2);
      font-weight: 600;
    }

    .controlBtn:disabled {
      opacity: .55;
      cursor: not-allowed;
      transform: none !important;
    }

    .toast {
      margin-top: 10px;
      padding: 12px 12px;
      border-radius: 14px;
      background: rgba(255, 255, 255, .06);
      border: 1px solid rgba(255, 255, 255, .12);
      color: var(--cream2);
      line-height: 1.55;
      font-size: 14px;
      min-height: 54px;
      display: flex;
      align-items: center;
    }

    .chocoStage {
      display: none;
      padding: 16px;
      border-top: 1px solid rgba(255, 255, 255, .10);
      background: radial-gradient(900px 420px at 20% 0%, rgba(226, 178, 75, .10), transparent 55%),
        radial-gradient(800px 420px at 80% 100%, rgba(255, 107, 134, .09), transparent 55%),
        rgba(0, 0, 0, .18);
    }

    .chocoStage.show {
      display: block;
    }

    .stageHeader {
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 10px;
      padding: 6px 4px 12px;
    }

    .stageHeader h2 {
      margin: 0;
      font-size: 18px;
    }

    .stageHeader .note {
      margin: 0;
      color: var(--cream2);
      font-size: 13px;
      max-width: 64ch;
      line-height: 1.5;
    }

    .boxWrap {
      display: grid;
      grid-template-columns: 1fr;
      gap: 14px;
    }

    .giftBox {
      border-radius: 22px;
      background: linear-gradient(180deg, rgba(0, 0, 0, .20), rgba(0, 0, 0, .35));
      border: 1px solid rgba(255, 255, 255, .12);
      padding: 16px;
      box-shadow: 0 18px 60px rgba(0, 0, 0, .45);
      position: relative;
      overflow: hidden;
    }

    .giftLid {
      position: absolute;
      inset: 0 0 auto 0;
      height: 54px;
      background: linear-gradient(180deg, rgba(226, 178, 75, .18), rgba(226, 178, 75, .06));
      border-bottom: 1px solid rgba(226, 178, 75, .22);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 750;
      letter-spacing: .14em;
      text-transform: uppercase;
      font-size: 12px;
      color: rgba(246, 234, 223, .92);
    }

    .tray {
      margin-top: 52px;
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 12px;
      padding: 14px 4px 4px;
    }

    @media (max-width: 520px) {
      .tray {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .choc {
      aspect-ratio: 1/1;
      border-radius: 18px;
      border: 1px solid rgba(255, 255, 255, .14);
      background:
        radial-gradient(22px 22px at 30% 25%, rgba(255, 255, 255, .14), transparent 55%),
        linear-gradient(180deg, rgba(58, 29, 22, .95), rgba(34, 16, 12, .95));
      box-shadow: 0 14px 28px rgba(0, 0, 0, .35);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      transition: transform .14s ease, border-color .14s ease, filter .14s ease;
      display: flex;
      align-items: flex-end;
      justify-content: flex-start;
      padding: 10px 10px;
      user-select: none;
    }

    .choc:hover {
      transform: translateY(-2px);
      border-color: rgba(226, 178, 75, .40);
      filter: brightness(1.03);
    }

    .choc:active {
      transform: translateY(-1px) scale(.99);
    }

    .chocTag {
      font-size: 12px;
      color: rgba(246, 234, 223, .92);
      background: rgba(0, 0, 0, .28);
      border: 1px solid rgba(255, 255, 255, .12);
      padding: 6px 9px;
      border-radius: 999px;
      backdrop-filter: blur(8px);
    }

    .choc::before {
      content: "";
      position: absolute;
      inset: -40% -60%;
      background: radial-gradient(circle at 30% 30%, rgba(226, 178, 75, .25), transparent 55%);
      transform: rotate(18deg);
      opacity: .55;
      pointer-events: none;
    }

    .footerNote {
      margin: 12px 2px 0;
      color: var(--cream2);
      font-size: 13px;
      line-height: 1.6;
      opacity: .95;
    }

    .modal {
      position: fixed;
      inset: 0;
      display: none;
      z-index: 50;
      background: rgba(0, 0, 0, .62);
      backdrop-filter: blur(10px);
      padding: 20px;
    }

    .modal.show {
      display: grid;
      place-items: center;
    }

    .modalCard {
      width: min(760px, 100%);
      border-radius: 22px;
      border: 1px solid rgba(255, 255, 255, .14);
      background: linear-gradient(180deg, rgba(255, 255, 255, .10), rgba(0, 0, 0, .25));
      box-shadow: 0 30px 110px rgba(0, 0, 0, .65);
      overflow: hidden;
    }

    .modalTop {
      padding: 14px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      border-bottom: 1px solid rgba(255, 255, 255, .12);
    }

    .modalTop h3 {
      margin: 0;
      font-size: 16px;
      letter-spacing: .01em;
    }

    .closeBtn {
      background: rgba(255, 255, 255, .08);
      border: 1px solid rgba(255, 255, 255, .14);
      color: var(--cream2);
      padding: 9px 12px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 650;
      transition: transform .12s ease, border-color .12s ease;
    }

    .closeBtn:hover {
      transform: translateY(-1px);
      border-color: rgba(226, 178, 75, .40);
    }

    .closeBtn:active {
      transform: translateY(0px) scale(.99);
    }

    .modalBody {
      padding: 16px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .modalBody p {
      margin: 0;
      color: var(--cream2);
      line-height: 1.75;
      font-size: 15px;
    }

    .quote {
      border-radius: 18px;
      border: 1px solid rgba(226, 178, 75, .22);
      background: rgba(226, 178, 75, .08);
      padding: 14px 14px;
      color: rgba(246, 234, 223, .96);
      line-height: 1.7;
      font-size: 15px;
    }

    .burst {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 60;
      overflow: hidden;
    }

    .heart {
      position: absolute;
      font-size: 14px;
      opacity: 0;
      transform: translateY(0) scale(1);
      animation: floatUp 1.4s ease forwards;
      filter: drop-shadow(0 10px 10px rgba(0, 0, 0, .35));
    }

    @keyframes floatUp {
      0% {
        opacity: 0;
        transform: translateY(12px) scale(.9);
      }

      10% {
        opacity: 1;
      }

      100% {
        opacity: 0;
        transform: translateY(-120px) scale(1.15);
      }
    }

    .muted {
      color: var(--cream2);
      opacity: .9;
    }

    .glow {
      text-shadow: 0 0 18px rgba(226, 178, 75, .18);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="titleBlock">
        <div class="kicker">Chocolate Day Delivery</div>
        <h1 class="glow" id="headline">A chocolate box on its way to Soline</h1>
        <p class="subtitle" id="subline">
          A tiny trip across the world, with little stops that carry the sweetest parts of us.
        </p>
      </div>

      <div class="pillRow">
        <div class="pill" title="Start pin">
          <span style="width:10px;height:10px;border-radius:999px;background:var(--gold);display:inline-block;"></span>
          From <strong id="fromCity">Geneva</strong>
        </div>
        <div class="pill" title="Destination pin">
          <span style="width:10px;height:10px;border-radius:999px;background:var(--rose);display:inline-block;"></span>
          To <strong id="toCity">Foug√®res</strong>
        </div>
        <div class="pill btn" id="editBtn" title="Quick edit the text (no coding)">
          ‚ú® Personalize
        </div>
      </div>
    </header>

    <div class="card">
      <div class="panel">
        <div class="mapArea" id="mapArea">
          <div class="mapGrid"></div>

          <div class="terrain" aria-hidden="true">
            <svg viewBox="0 0 1200 700" preserveAspectRatio="none">
              <path
                d="M0,520 C180,420 260,520 420,450 C560,380 680,540 820,460 C930,410 1020,430 1200,360 L1200,700 L0,700 Z"
                fill="rgba(255,255,255,.05)" />
              <path
                d="M0,560 C180,490 300,590 460,520 C610,450 690,620 860,540 C980,490 1070,530 1200,460 L1200,700 L0,700 Z"
                fill="rgba(226,178,75,.06)" />
              <path
                d="M0,610 C220,560 340,640 520,600 C710,560 820,700 980,640 C1080,600 1120,630 1200,590 L1200,700 L0,700 Z"
                fill="rgba(255,107,134,.05)" />
              <circle cx="220" cy="170" r="130" fill="rgba(226,178,75,.07)" />
              <circle cx="940" cy="210" r="160" fill="rgba(255,107,134,.06)" />
              <circle cx="720" cy="120" r="90" fill="rgba(123,242,201,.05)" />
            </svg>
          </div>

          <div class="routeLayer">
            <svg id="routeSvg" viewBox="0 0 1000 600" preserveAspectRatio="none" style="width:100%;height:100%;">
              <defs>
                <linearGradient id="routeGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" stop-color="rgba(226,178,75,.85)" />
                  <stop offset="55%" stop-color="rgba(255,255,255,.30)" />
                  <stop offset="100%" stop-color="rgba(255,107,134,.85)" />
                </linearGradient>
                <filter id="softGlow">
                  <feGaussianBlur stdDeviation="2.2" result="blur" />
                  <feMerge>
                    <feMergeNode in="blur" />
                    <feMergeNode in="SourceGraphic" />
                  </feMerge>
                </filter>
              </defs>

              <path id="routePath" d="M130 430
                   C 260 340, 290 250, 360 220
                   C 460 180, 520 310, 610 260
                   C 700 210, 760 170, 860 170" fill="none" stroke="url(#routeGrad)" stroke-width="3.5"
                stroke-linecap="round" stroke-dasharray="6 10" opacity=".9" filter="url(#softGlow)" />
              <path id="routePathGlow" d="M130 430
                   C 260 340, 290 250, 360 220
                   C 460 180, 520 310, 610 260
                   C 700 210, 760 170, 860 170" fill="none" stroke="rgba(226,178,75,.20)" stroke-width="10"
                stroke-linecap="round" opacity=".6" filter="url(#softGlow)" />
            </svg>
          </div>

          <div class="pin" id="pinFrom" style="left:13%; top:78%;">
            <div class="pinTop">
              <div class="pinDot"></div>
            </div>
            <div class="pinLabel" id="pinFromLabel">Geneva</div>
          </div>

          <div class="pin" id="pinTo" style="left:86%; top:31%;">
            <div class="pinTop">
              <div class="pinDot"
                style="background:var(--rose); box-shadow:0 0 0 6px rgba(255,107,134,.20), 0 0 18px rgba(255,107,134,.20)">
              </div>
            </div>
            <div class="pinLabel" id="pinToLabel">Foug√®res</div>
          </div>

          <div class="checkpoint" id="cp0" style="left:26%; top:60%;"></div>
          <div class="checkpoint" id="cp1" style="left:36%; top:38%;"></div>
          <div class="checkpoint" id="cp2" style="left:51%; top:34%;"></div>
          <div class="checkpoint" id="cp3" style="left:61%; top:45%;"></div>
          <div class="checkpoint" id="cp4" style="left:74%; top:32%;"></div>

          <div class="parcel" id="parcel" style="left:13%; top:78%;">
            <div class="parcelBubble" id="parcelBubble">Packing sweetness‚Ä¶</div>

            <!-- BLACK VAN -->
            <svg viewBox="0 0 64 64" aria-hidden="true">
              <defs>
                <linearGradient id="vanBody" x1="0" x2="0" y1="0" y2="1">
                  <stop offset="0" stop-color="rgba(255,255,255,.10)" />
                  <stop offset="1" stop-color="rgba(255,255,255,.02)" />
                </linearGradient>
              </defs>

              <!-- shadow -->
              <ellipse cx="32" cy="54" rx="22" ry="6" fill="rgba(0,0,0,.35)" />

              <!-- body -->
              <path d="M12 36
                       C12 30, 15 26, 21 26
                       L38 26
                       C46 26, 51 30, 54 36
                       L56 40
                       C57 42, 56 44, 54 44
                       L12 44
                       C10 44, 9 42, 10 40
                       L12 36 Z" fill="rgba(0,0,0,.80)" stroke="rgba(255,255,255,.14)" stroke-width="1.2" />

              <!-- cabin block -->
              <path d="M21 26
                       L21 22
                       C21 18, 24 15, 28 15
                       L38 15
                       C44 15, 48 18, 50 23
                       L54 36
                       L38 36
                       C34 36, 31 33, 31 29
                       L31 26
                       Z" fill="rgba(0,0,0,.68)" stroke="rgba(255,255,255,.12)" stroke-width="1" />

              <!-- window -->
              <path d="M30 18
                       L38 18
                       C41 18, 44 19, 45 22
                       L47 26
                       L33 26
                       C31 26, 30 25, 30 23
                       Z" fill="rgba(226,178,75,.18)" stroke="rgba(226,178,75,.22)" stroke-width="1" />

              <!-- door line -->
              <path d="M31 26 L31 44" stroke="rgba(255,255,255,.10)" stroke-width="1" />

              <!-- accent stripe -->
              <path d="M14 39 L54 39" stroke="rgba(226,178,75,.35)" stroke-width="2.2" stroke-linecap="round" />

              <!-- wheels -->
              <g>
                <circle cx="22" cy="44" r="7" fill="rgba(0,0,0,.92)" stroke="rgba(255,255,255,.18)" stroke-width="1" />
                <circle cx="22" cy="44" r="3" fill="rgba(255,255,255,.08)" />
                <circle cx="46" cy="44" r="7" fill="rgba(0,0,0,.92)" stroke="rgba(255,255,255,.18)" stroke-width="1" />
                <circle cx="46" cy="44" r="3" fill="rgba(255,255,255,.08)" />
              </g>

              <!-- tiny heart cargo sticker -->
              <path
                d="M20 33 C18.2 33, 17 34.4, 17 35.9 C17 38.2, 20 40.2, 20 40.2 C20 40.2, 23 38.2, 23 35.9 C23 34.4, 21.8 33, 20 33 Z"
                fill="rgba(255,107,134,.72)" />
            </svg>
          </div>
        </div>

        <div class="side">
          <div class="sideCard">
            <h2>Trip status</h2>
            <p id="statusText">Your chocolate box is ready at the start point. Hit Start to send it.</p>

            <div class="progressWrap">
              <div class="metaRow">
                <div>Progress</div>
                <div id="progressLabel">0%</div>
              </div>
              <div class="bar">
                <div id="barFill"></div>
              </div>
              <div class="metaRow">
                <div class="muted" id="stopLabel">Next stop: First memory</div>
                <div class="muted" id="timeLabel">0 of 6</div>
              </div>
            </div>

            <div class="controls">
              <button class="controlBtn btn" id="startBtn">üöÄ Start delivery</button>
              <button class="controlBtn secondary btn" id="skipBtn" disabled>‚è≠Ô∏è Skip to box</button>
            </div>

            <div class="toast" id="toast">
              A little note will appear here at each stop.
            </div>
          </div>

          <div class="sideCard">
            <h2>What this is</h2>
            <p>
              A tiny travel story where the package carries our moments.
              When it arrives, the box opens into chocolates you can tap.
            </p>
          </div>
        </div>
      </div>

      <div class="chocoStage" id="chocoStage">
        <div class="stageHeader">
          <h2 id="boxTitle">The box arrived</h2>
          <p class="note" id="boxNote">
            Tap a chocolate. Each one holds a little piece of us.
          </p>
        </div>

        <div class="boxWrap">
          <div class="giftBox">
            <div class="giftLid">CHOCOLATE BOX</div>
            <div class="tray" id="tray"></div>
          </div>

          <p class="footerNote" id="finalLine">
            Distance melts. Love stays. Happy Chocolate Day, Soline.
          </p>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" id="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modalCard">
      <div class="modalTop">
        <h3 id="modalTitle">A sweet note</h3>
        <button class="closeBtn" id="closeModal">Close</button>
      </div>
      <div class="modalBody">
        <div class="quote" id="modalQuote"></div>
        <p id="modalBody"></p>
      </div>
    </div>
  </div>

  <div class="burst" id="burst" aria-hidden="true"></div>

  <script>
    const CONFIG = {
      herName: "Soline",
      fromCity: "Geneva",
      toCity: "Foug√®res",
      headline: "A chocolate box on its way to Soline",
      subline: "A tiny trip across the world, with little stops that carry the sweetest parts of us.",
      finalLine: "Distance melts. Love stays. Happy Chocolate Day, Soline.",

      stops: [
        { bubble: "Packing sweetness‚Ä¶", status: "Packed with a little warmth and a lot of you on my mind.", toast: "Stop 1. A small reminder: you feel like home, even from far away." },
        { bubble: "Rolling out‚Ä¶", status: "On the move. One step closer to you.", toast: "Stop 2. Remember our late night calls. The world gets quieter, and you get closer." },
        { bubble: "Crossing skies‚Ä¶", status: "Passing time zones, keeping you constant.", toast: "Stop 3. If I could mail a hug, it would arrive every morning." },
        { bubble: "Almost there‚Ä¶", status: "The distance is just geography. You are the destination.", toast: "Stop 4. I love how you make ordinary days feel special." },
        { bubble: "Arriving‚Ä¶", status: "At your door, with a box full of sweetness.", toast: "Stop 5. Open the box. Each chocolate is a tiny love letter." }
      ],

      chocolates: [
        { tag: "Dark", title: "Dark chocolate", quote: "Strong, steady, real.", body: "That is how I feel about us. Even when the days are busy, you are still my calm." },
        { tag: "Caramel", title: "Caramel", quote: "Soft in the middle.", body: "Like your voice when you say my name. It always melts my stress." },
        { tag: "Hazelnut", title: "Hazelnut", quote: "Warm and comforting.", body: "I miss the simple things, sitting with you, sharing a look, saying nothing." },
        { tag: "Strawberry", title: "Strawberry", quote: "Playful sweetness.", body: "You make me smile in the most unexpected moments. Even a normal day turns bright." },
        { tag: "Almond", title: "Almond", quote: "A little crunch of courage.", body: "We are doing the hard thing, loving across distance. I am proud of us." },
        { tag: "Mint", title: "Mint", quote: "Fresh start energy.", body: "Every day I choose you again. Not out of habit, but out of love." },
        { tag: "Praline", title: "Praline", quote: "Sweet with depth.", body: "I love the way you think, the way you care, the way you show up as you." },
        { tag: "Coffee", title: "Coffee", quote: "A little kick of joy.", body: "If we were together right now, I would save you the first sip, always." },
        { tag: "Vanilla", title: "Vanilla", quote: "Simple and perfect.", body: "Sometimes I just want to say it plainly. I love you. I miss you. I am yours." },
        { tag: "Sea salt", title: "Sea salt", quote: "Sweet and honest.", body: "I want all of you, the good days and the messy days. I am here for everything." },
        { tag: "Raspberry", title: "Raspberry", quote: "A bright little spark.", body: "Thank you for being my favorite notification, my favorite thought, my favorite person." },
        { tag: "Surprise", title: "Surprise", quote: "Future flavor.", body: "One day this distance will be a story we tell while sharing real chocolates on the same couch." }
      ]
    };

    const els = {
      headline: document.getElementById("headline"),
      subline: document.getElementById("subline"),
      fromCity: document.getElementById("fromCity"),
      toCity: document.getElementById("toCity"),
      pinFromLabel: document.getElementById("pinFromLabel"),
      pinToLabel: document.getElementById("pinToLabel"),

      startBtn: document.getElementById("startBtn"),
      skipBtn: document.getElementById("skipBtn"),
      statusText: document.getElementById("statusText"),
      toast: document.getElementById("toast"),
      barFill: document.getElementById("barFill"),
      progressLabel: document.getElementById("progressLabel"),
      stopLabel: document.getElementById("stopLabel"),
      timeLabel: document.getElementById("timeLabel"),

      parcel: document.getElementById("parcel"),
      bubble: document.getElementById("parcelBubble"),

      cps: [
        document.getElementById("cp0"),
        document.getElementById("cp1"),
        document.getElementById("cp2"),
        document.getElementById("cp3"),
        document.getElementById("cp4"),
      ],

      chocoStage: document.getElementById("chocoStage"),
      tray: document.getElementById("tray"),
      boxTitle: document.getElementById("boxTitle"),
      finalLine: document.getElementById("finalLine"),

      modal: document.getElementById("modal"),
      modalTitle: document.getElementById("modalTitle"),
      modalQuote: document.getElementById("modalQuote"),
      modalBody: document.getElementById("modalBody"),
      closeModal: document.getElementById("closeModal"),

      burst: document.getElementById("burst"),
      editBtn: document.getElementById("editBtn")
    };

    function applyConfig() {
      const name = CONFIG.herName || "Love";
      els.fromCity.textContent = CONFIG.fromCity;
      els.toCity.textContent = CONFIG.toCity;
      els.pinFromLabel.textContent = CONFIG.fromCity;
      els.pinToLabel.textContent = CONFIG.toCity;

      els.headline.textContent = CONFIG.headline.replaceAll("Soline", name);
      els.subline.textContent = CONFIG.subline;

      els.finalLine.textContent = CONFIG.finalLine.replaceAll("Soline", name);
      document.getElementById("boxTitle").textContent = `The box arrived for ${name}`;
    }
    applyConfig();

    const routePath = document.getElementById("routePath");
    const path = routePath;
    const pathLen = path.getTotalLength();

    let running = false;
    let stepIndex = 0;
    let t = 0;
    let raf = null;

    const timeline = [
      { t: 0.00, cp: -1, stop: null },
      { t: 0.18, cp: 0, stop: 0 },
      { t: 0.36, cp: 1, stop: 1 },
      { t: 0.52, cp: 2, stop: 2 },
      { t: 0.70, cp: 3, stop: 3 },
      { t: 0.86, cp: 4, stop: 4 },
      { t: 1.00, cp: -1, stop: "arrive" }
    ];

    function setParcelAt(tt) {
      const p = path.getPointAtLength(tt * pathLen);
      const px = (p.x / 1000) * 100;
      const py = (p.y / 600) * 100;
      els.parcel.style.left = px + "%";
      els.parcel.style.top = py + "%";
    }

    function setProgress(tt) {
      const pct = Math.max(0, Math.min(100, Math.round(tt * 100)));
      els.progressLabel.textContent = pct + "%";
      els.barFill.style.width = pct + "%";
    }

    function highlightCheckpoint(i) {
      els.cps.forEach((cp, idx) => cp.classList.toggle("active", idx === i));
    }

    function showBubble(text) {
      els.bubble.textContent = text;
      els.bubble.classList.add("show");
      window.setTimeout(() => els.bubble.classList.remove("show"), 1400);
    }

    function setSideText(status, toast) {
      els.statusText.textContent = status;
      els.toast.textContent = toast;
    }

    function setMeta(nextStopLabel, idx, total) {
      els.stopLabel.textContent = nextStopLabel;
      els.timeLabel.textContent = `${idx} of ${total}`;
    }

    function burstHearts(x, y) {
      const hearts = ["üíõ", "üç´", "üíó", "‚ú®", "üíû"];
      const n = 12;
      for (let i = 0; i < n; i++) {
        const el = document.createElement("div");
        el.className = "heart";
        el.textContent = hearts[Math.floor(Math.random() * hearts.length)];
        const dx = (Math.random() * 120 - 60);
        const dy = (Math.random() * 30 - 10);
        el.style.left = (x + dx) + "px";
        el.style.top = (y + dy) + "px";
        el.style.animationDelay = (Math.random() * 0.08) + "s";
        el.style.fontSize = (12 + Math.random() * 14) + "px";
        els.burst.appendChild(el);
        window.setTimeout(() => el.remove(), 1600);
      }
    }

    function openBox() {
      els.chocoStage.classList.add("show");
      els.skipBtn.disabled = true;
      els.startBtn.disabled = true;
      els.startBtn.textContent = "‚úÖ Delivered";
      highlightCheckpoint(-1);

      const name = CONFIG.herName || "Love";
      setSideText(
        `Delivered. This one is for you, ${name}.`,
        `Tap a chocolate below. Each one holds a little love note, just for you.`
      );

      renderChocolates();
      window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
    }

    function renderChocolates() {
      els.tray.innerHTML = "";
      CONFIG.chocolates.forEach((c) => {
        const d = document.createElement("div");
        d.className = "choc";
        d.setAttribute("role", "button");
        d.setAttribute("tabindex", "0");
        d.innerHTML = `<div class="chocTag">${escapeHtml(c.tag)}</div>`;
        d.addEventListener("click", () => {
          const rect = d.getBoundingClientRect();
          burstHearts(rect.left + rect.width / 2, rect.top + rect.height / 2);
          openModal(c);
        });
        d.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            d.click();
          }
        });
        els.tray.appendChild(d);
      });
    }

    function openModal(choc) {
      els.modalTitle.textContent = choc.title;
      els.modalQuote.textContent = choc.quote;
      els.modalBody.textContent = choc.body.replaceAll("Soline", CONFIG.herName || "Love");
      els.modal.classList.add("show");
    }
    function closeModal() { els.modal.classList.remove("show"); }
    els.closeModal.addEventListener("click", closeModal);
    els.modal.addEventListener("click", (e) => { if (e.target === els.modal) closeModal(); });
    document.addEventListener("keydown", (e) => { if (e.key === "Escape" && els.modal.classList.contains("show")) closeModal(); });

    function escapeHtml(s) {
      return String(s).replaceAll("&", "&amp;").replaceAll("<", "&lt;").replaceAll(">", "&gt;").replaceAll('"', "&quot;");
    }

    function goToMoment(targetIndex) {
      const from = t;
      const to = timeline[targetIndex].t;
      const duration = 850 + Math.abs(to - from) * 1100;
      const start = performance.now();
      const ease = (u) => 1 - Math.pow(1 - u, 3);

      function frame(now) {
        const u = Math.min(1, (now - start) / duration);
        const k = ease(u);
        t = from + (to - from) * k;
        setParcelAt(t);
        setProgress(t);

        if (u < 1) {
          raf = requestAnimationFrame(frame);
        } else {
          onArriveMoment(targetIndex);
        }
      }
      cancelAnimationFrame(raf);
      raf = requestAnimationFrame(frame);
    }

    function onArriveMoment(idx) {
      const m = timeline[idx];

      if (m.cp >= 0) highlightCheckpoint(m.cp);
      else highlightCheckpoint(-1);

      if (m.stop === "arrive") {
        showBubble("Delivered üíõ");
        setMeta("Done", 6, 6);
        openBox();
        return;
      }

      if (typeof m.stop === "number") {
        const s = CONFIG.stops[m.stop];
        showBubble(s.bubble);
        setSideText(s.status, s.toast);
        setMeta("Next stop: keep going", idx, 6);
        els.skipBtn.disabled = false;

        const pr = els.parcel.getBoundingClientRect();
        burstHearts(pr.left + pr.width / 2, pr.top + pr.height / 2);
      }
    }

    function startDelivery() {
      if (running) return;
      running = true;
      els.startBtn.disabled = true;
      els.startBtn.textContent = "üöö Delivering‚Ä¶";
      stepIndex = 1;

      setMeta("Next stop: first memory", 0, 6);
      setSideText(
        "Started. The route is set and the van is moving.",
        "You will see a sweet note at every stop."
      );
      showBubble("Leaving Geneva‚Ä¶");
      highlightCheckpoint(-1);

      function next() {
        if (stepIndex >= timeline.length) {
          running = false;
          return;
        }
        goToMoment(stepIndex);
        stepIndex++;

        window.setTimeout(() => {
          if (stepIndex < timeline.length && els.chocoStage.classList.contains("show") === false) {
            next();
          }
        }, 1550);
      }
      next();
    }

    function skipToBox() {
      if (els.chocoStage.classList.contains("show")) return;
      cancelAnimationFrame(raf);
      t = 1.0;
      setParcelAt(t);
      setProgress(t);
      openBox();
    }

    setParcelAt(0);
    setProgress(0);
    setMeta("Next stop: first memory", 0, 6);
    highlightCheckpoint(-1);

    els.startBtn.addEventListener("click", startDelivery);
    els.skipBtn.addEventListener("click", skipToBox);

    els.editBtn.addEventListener("click", () => {
      const name = prompt("Her name", CONFIG.herName) ?? CONFIG.herName;
      const toCity = prompt("Her city (label only)", CONFIG.toCity) ?? CONFIG.toCity;
      const fromCity = prompt("Your city (label only)", CONFIG.fromCity) ?? CONFIG.fromCity;

      CONFIG.herName = name.trim() || CONFIG.herName;
      CONFIG.toCity = toCity.trim() || CONFIG.toCity;
      CONFIG.fromCity = fromCity.trim() || CONFIG.fromCity;

      CONFIG.headline = `A chocolate box on its way to ${CONFIG.herName}`;
      CONFIG.finalLine = `Distance melts. Love stays. Happy Chocolate Day, ${CONFIG.herName}.`;

      applyConfig();
      showBubble("Updated ‚ú®");
      setSideText("Personalized. Ready when you are.", "Hit Start to send it.");
    });

    window.addEventListener("resize", () => setParcelAt(t));
  </script>
</body>

</html>